{#
Portal Landing Page - Main Dashboard
Central hub for portal users to access all features
#}
{% extends "templates/web.html" %}

{% block title %}{{ _("Portal") }}{% endblock %}

{% block style %}
<style>
.portal-dashboard {
	padding: 2rem 0;
}
.portal-hero {
	background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%);
	color: white;
	padding: 3rem 2rem;
	border-radius: 12px;
	margin-bottom: 2rem;
}
.portal-hero h1 {
	font-size: 2.5rem;
	font-weight: 700;
	margin-bottom: 0.5rem;
}
.portal-hero .subtitle {
	font-size: 1.1rem;
	opacity: 0.85;
}
.portal-card {
	background: white;
	border-radius: 12px;
	box-shadow: 0 2px 12px rgba(0,0,0,0.08);
	transition: all 0.3s ease;
	height: 100%;
	overflow: hidden;
}
.portal-card:hover {
	transform: translateY(-4px);
	box-shadow: 0 8px 24px rgba(0,0,0,0.12);
}
.portal-card-header {
	padding: 1.5rem;
	display: flex;
	align-items: center;
	gap: 1rem;
	border-bottom: 1px solid #eee;
}
.portal-card-icon {
	width: 48px;
	height: 48px;
	border-radius: 10px;
	display: flex;
	align-items: center;
	justify-content: center;
	font-size: 1.4rem;
}
.portal-card-icon.projects { background: #e3f2fd; color: #1976d2; }
.portal-card-icon.orders { background: #e8f5e9; color: #388e3c; }
.portal-card-icon.drawings { background: #fff3e0; color: #f57c00; }
.portal-card-icon.resources { background: #f3e5f5; color: #7b1fa2; }
.portal-card-icon.support { background: #fce4ec; color: #c2185b; }
.portal-card-icon.account { background: #e0f7fa; color: #0097a7; }
.portal-card-body {
	padding: 1.5rem;
}
.portal-card-body p {
	color: #666;
	margin-bottom: 1rem;
}
.portal-card-footer {
	padding: 1rem 1.5rem;
	background: #fafafa;
	border-top: 1px solid #eee;
}
.stat-badge {
	display: inline-flex;
	align-items: center;
	gap: 0.5rem;
	padding: 0.25rem 0.75rem;
	border-radius: 20px;
	font-size: 0.875rem;
	font-weight: 500;
}
.stat-badge.active { background: #e8f5e9; color: #2e7d32; }
.stat-badge.pending { background: #fff3e0; color: #ef6c00; }
.stat-badge.new { background: #e3f2fd; color: #1565c2; }
.quick-actions {
	display: flex;
	flex-wrap: wrap;
	gap: 0.5rem;
}
.quick-actions .btn-sm {
	font-size: 0.8rem;
	padding: 0.375rem 0.75rem;
}
.recent-list {
	list-style: none;
	padding: 0;
	margin: 0;
}
.recent-list li {
	padding: 0.75rem 0;
	border-bottom: 1px solid #f0f0f0;
	display: flex;
	justify-content: space-between;
	align-items: center;
}
.recent-list li:last-child {
	border-bottom: none;
}
.recent-list .item-name {
	font-weight: 500;
	color: #333;
}
.recent-list .item-meta {
	font-size: 0.8rem;
	color: #888;
}
.section-title {
	font-size: 1.25rem;
	font-weight: 600;
	margin-bottom: 1.5rem;
	color: #333;
}
</style>
{% endblock %}

{% block page_content %}
<div class="container portal-dashboard">
	<!-- Hero Section -->
	<div class="portal-hero">
		<h1>{{ _("Welcome back") }}{% if user_name %}, {{ user_name }}{% endif %}</h1>
		<p class="subtitle">{{ _("Your ilLumenate Lighting portal dashboard") }}</p>
	</div>

	<!-- Main Feature Cards -->
	<div class="row mb-4">
		<!-- Projects Card -->
		<div class="col-md-6 col-lg-4 mb-4">
			<div class="portal-card">
				<div class="portal-card-header">
					<div class="portal-card-icon projects">
						<i class="fa fa-folder-open"></i>
					</div>
					<div>
						<h5 class="mb-0">{{ _("Projects") }}</h5>
						<small class="text-muted">{{ _("Fixture schedules & configurations") }}</small>
					</div>
				</div>
				<div class="portal-card-body">
					<p>{{ _("Create and manage lighting projects. Build fixture schedules and configure custom lighting solutions.") }}</p>
					<div class="d-flex gap-2">
						{% if stats.active_projects > 0 %}
						<span class="stat-badge active">
							<i class="fa fa-check-circle"></i> {{ stats.active_projects }} {{ _("Active") }}
						</span>
						{% endif %}
						{% if stats.total_schedules > 0 %}
						<span class="stat-badge new">
							<i class="fa fa-list"></i> {{ stats.total_schedules }} {{ _("Schedules") }}
						</span>
						{% endif %}
					</div>
				</div>
				<div class="portal-card-footer">
					<div class="quick-actions">
						<a href="/portal/projects" class="btn btn-primary btn-sm">
							<i class="fa fa-folder"></i> {{ _("View Projects") }}
						</a>
						<a href="/portal/projects/new" class="btn btn-outline-primary btn-sm">
							<i class="fa fa-plus"></i> {{ _("New Project") }}
						</a>
					</div>
				</div>
			</div>
		</div>

		<!-- Sales Orders Card -->
		<div class="col-md-6 col-lg-4 mb-4">
			<div class="portal-card">
				<div class="portal-card-header">
					<div class="portal-card-icon orders">
						<i class="fa fa-shopping-cart"></i>
					</div>
					<div>
						<h5 class="mb-0">{{ _("Sales Orders") }}</h5>
						<small class="text-muted">{{ _("Track orders & shipments") }}</small>
					</div>
				</div>
				<div class="portal-card-body">
					<p>{{ _("View your sales orders, track production status, and monitor shipment progress.") }}</p>
					<div class="d-flex gap-2 flex-wrap">
						{% if stats.pending_orders > 0 %}
						<span class="stat-badge pending">
							<i class="fa fa-clock-o"></i> {{ stats.pending_orders }} {{ _("In Production") }}
						</span>
						{% endif %}
						{% if stats.ready_orders > 0 %}
						<span class="stat-badge active">
							<i class="fa fa-truck"></i> {{ stats.ready_orders }} {{ _("Ready to Ship") }}
						</span>
						{% endif %}
					</div>
				</div>
				<div class="portal-card-footer">
					<div class="quick-actions">
						<a href="/portal/orders" class="btn btn-success btn-sm">
							<i class="fa fa-list-alt"></i> {{ _("View Orders") }}
						</a>
					</div>
				</div>
			</div>
		</div>

		<!-- Drawings & Resources Card -->
		<div class="col-md-6 col-lg-4 mb-4">
			<div class="portal-card">
				<div class="portal-card-header">
					<div class="portal-card-icon drawings">
						<i class="fa fa-file-pdf-o"></i>
					</div>
					<div>
						<h5 class="mb-0">{{ _("Drawings & Docs") }}</h5>
						<small class="text-muted">{{ _("Technical drawings & specs") }}</small>
					</div>
				</div>
				<div class="portal-card-body">
					<p>{{ _("Request custom drawings, download spec sheets, and access technical documentation.") }}</p>
					<div class="d-flex gap-2 flex-wrap">
						{% if stats.pending_drawings > 0 %}
						<span class="stat-badge pending">
							<i class="fa fa-hourglass-half"></i> {{ stats.pending_drawings }} {{ _("Pending") }}
						</span>
						{% endif %}
						{% if stats.ready_drawings > 0 %}
						<span class="stat-badge active">
							<i class="fa fa-check"></i> {{ stats.ready_drawings }} {{ _("Ready") }}
						</span>
						{% endif %}
					</div>
				</div>
				<div class="portal-card-footer">
					<div class="quick-actions">
						<a href="/portal/drawings" class="btn btn-warning btn-sm">
							<i class="fa fa-pencil-square-o"></i> {{ _("Request Drawing") }}
						</a>
						<a href="/portal/resources" class="btn btn-outline-warning btn-sm">
							<i class="fa fa-book"></i> {{ _("Resources") }}
						</a>
					</div>
				</div>
			</div>
		</div>
	</div>

	<!-- Secondary Row -->
	<div class="row mb-4">
		<!-- Support Card -->
		<div class="col-md-6 mb-4">
			<div class="portal-card">
				<div class="portal-card-header">
					<div class="portal-card-icon support">
						<i class="fa fa-life-ring"></i>
					</div>
					<div>
						<h5 class="mb-0">{{ _("Support") }}</h5>
						<small class="text-muted">{{ _("Help & inquiries") }}</small>
					</div>
				</div>
				<div class="portal-card-body">
					<p>{{ _("Need assistance? Submit a support request or browse our FAQ and troubleshooting guides.") }}</p>
				</div>
				<div class="portal-card-footer">
					<div class="quick-actions">
						<a href="/portal/support" class="btn btn-danger btn-sm">
							<i class="fa fa-ticket"></i> {{ _("Submit Request") }}
						</a>
						<a href="/portal/support/faq" class="btn btn-outline-danger btn-sm">
							<i class="fa fa-question-circle"></i> {{ _("FAQ") }}
						</a>
					</div>
				</div>
			</div>
		</div>

		<!-- Account Card -->
		<div class="col-md-6 mb-4">
			<div class="portal-card">
				<div class="portal-card-header">
					<div class="portal-card-icon account">
						<i class="fa fa-user-circle"></i>
					</div>
					<div>
						<h5 class="mb-0">{{ _("My Account") }}</h5>
						<small class="text-muted">{{ _("Profile & preferences") }}</small>
					</div>
				</div>
				<div class="portal-card-body">
					<p>{{ _("Manage your profile, notification preferences, and account settings.") }}</p>
					<div class="d-flex gap-2">
						<span class="stat-badge new">
							<i class="fa fa-building"></i> {{ customer_name or _("No company linked") }}
						</span>
					</div>
				</div>
				<div class="portal-card-footer">
					<div class="quick-actions">
						<a href="/portal/account" class="btn btn-info btn-sm">
							<i class="fa fa-cog"></i> {{ _("Settings") }}
						</a>
						<a href="/portal/account/notifications" class="btn btn-outline-info btn-sm">
							<i class="fa fa-bell"></i> {{ _("Notifications") }}
						</a>
					</div>
				</div>
			</div>
		</div>
	</div>

	<!-- Recent Activity Section -->
	<div class="row">
		<!-- Recent Projects -->
		<div class="col-md-6 mb-4">
			<div class="portal-card">
				<div class="portal-card-header">
					<h5 class="mb-0">{{ _("Recent Projects") }}</h5>
				</div>
				<div class="portal-card-body">
					{% if recent_projects %}
					<ul class="recent-list">
						{% for project in recent_projects[:5] %}
						<li>
							<div>
								<a href="/portal/projects/{{ project.name }}" class="item-name">{{ project.project_name }}</a>
								<div class="item-meta">{{ project.customer }}</div>
							</div>
							<span class="badge badge-{{ 'success' if project.status == 'ACTIVE' else 'secondary' }}">
								{{ project.status }}
							</span>
						</li>
						{% endfor %}
					</ul>
					{% else %}
					<p class="text-muted text-center py-3">
						<i class="fa fa-folder-open-o fa-2x mb-2"></i><br>
						{{ _("No projects yet. Create your first project to get started!") }}
					</p>
					{% endif %}
				</div>
			</div>
		</div>

		<!-- Recent Orders -->
		<div class="col-md-6 mb-4">
			<div class="portal-card">
				<div class="portal-card-header">
					<h5 class="mb-0">{{ _("Recent Orders") }}</h5>
				</div>
				<div class="portal-card-body">
					{% if recent_orders %}
					<ul class="recent-list">
						{% for order in recent_orders[:5] %}
						<li>
							<div>
								<a href="/portal/orders/{{ order.name }}" class="item-name">{{ order.name }}</a>
								<div class="item-meta">{{ frappe.utils.format_date(order.transaction_date) }}</div>
							</div>
							<span class="badge badge-{{ order_status_class(order.status) }}">
								{{ order.status }}
							</span>
						</li>
						{% endfor %}
					</ul>
					{% else %}
					<p class="text-muted text-center py-3">
						<i class="fa fa-shopping-cart fa-2x mb-2"></i><br>
						{{ _("No orders yet.") }}
					</p>
					{% endif %}
				</div>
			</div>
		</div>
	</div>
</div>
{% endblock %}
