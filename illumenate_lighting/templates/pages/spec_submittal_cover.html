<!DOCTYPE html>
<html>
<head>
	<meta charset="UTF-8">
	<title>Spec Submittal Packet - {{ schedule.schedule_name }}</title>
	<style>
		body {
			font-family: Arial, Helvetica, sans-serif;
			margin: 0;
			padding: 40px;
			color: #333;
		}
		.header {
			text-align: center;
			margin-bottom: 40px;
			border-bottom: 2px solid #1a365d;
			padding-bottom: 20px;
		}
		.company-name {
			font-size: 24px;
			font-weight: bold;
			color: #1a365d;
			margin-bottom: 10px;
		}
		.document-title {
			font-size: 20px;
			color: #4a5568;
			margin-top: 20px;
		}
		.project-info {
			margin: 30px 0;
			padding: 20px;
			background-color: #f7fafc;
			border-radius: 8px;
		}
		.project-info h2 {
			font-size: 16px;
			color: #1a365d;
			margin-top: 0;
			margin-bottom: 15px;
			border-bottom: 1px solid #e2e8f0;
			padding-bottom: 10px;
		}
		.info-row {
			display: flex;
			margin-bottom: 8px;
		}
		.info-label {
			font-weight: bold;
			width: 150px;
			color: #4a5568;
		}
		.info-value {
			flex: 1;
		}
		.fixture-table {
			width: 100%;
			border-collapse: collapse;
			margin-top: 30px;
		}
		.fixture-table th {
			background-color: #1a365d;
			color: white;
			padding: 12px 8px;
			text-align: left;
			font-size: 12px;
		}
		.fixture-table td {
			padding: 10px 8px;
			border-bottom: 1px solid #e2e8f0;
			font-size: 11px;
		}
		.fixture-table tr:nth-child(even) {
			background-color: #f7fafc;
		}
		.fixture-table tr:hover {
			background-color: #edf2f7;
		}
		.status-configured {
			color: #38a169;
			font-weight: bold;
		}
		.status-pending {
			color: #d69e2e;
			font-weight: bold;
		}
		.status-other {
			color: #4a5568;
		}
		.footer {
			margin-top: 40px;
			padding-top: 20px;
			border-top: 1px solid #e2e8f0;
			text-align: center;
			font-size: 10px;
			color: #718096;
		}
		.toc-title {
			font-size: 16px;
			color: #1a365d;
			margin-top: 30px;
			margin-bottom: 15px;
		}
		.has-spec {
			color: #38a169;
		}
		.no-spec {
			color: #e53e3e;
		}
		.page-break {
			page-break-after: always;
		}
	</style>
</head>
<body>
	<div class="header">
		<div class="company-name">{{ company_name }}</div>
		<div class="document-title">Spec Submittal Packet</div>
	</div>

	<div class="project-info">
		<h2>Project Information</h2>
		{% if project %}
		<div class="info-row">
			<span class="info-label">Project Name:</span>
			<span class="info-value">{{ project.project_name }}</span>
		</div>
		{% if project.customer %}
		<div class="info-row">
			<span class="info-label">Customer:</span>
			<span class="info-value">{{ project.customer }}</span>
		</div>
		{% endif %}
		{% endif %}
		<div class="info-row">
			<span class="info-label">Schedule Name:</span>
			<span class="info-value">{{ schedule.schedule_name }}</span>
		</div>
		{% if generation_date %}
		<div class="info-row">
			<span class="info-label">Generated:</span>
			<span class="info-value">{{ generation_date }}</span>
		</div>
		{% endif %}
	</div>

	<h3 class="toc-title">Fixture Schedule - Table of Contents</h3>
	
	<table class="fixture-table">
		<thead>
			<tr>
				<th>Line ID</th>
				<th>Qty</th>
				<th>Location</th>
				<th>Type</th>
				<th>Status</th>
				<th>Spec Sheet</th>
			</tr>
		</thead>
		<tbody>
			{% for line in fixture_lines %}
			<tr>
				<td><strong>{{ line.line_id or '-' }}</strong></td>
				<td>{{ line.qty or 1 }}</td>
				<td>{{ line.location or '-' }}</td>
				<td>
					{% if line.manufacturer_type == 'ILLUMENATE' %}
						ilLumenate
					{% elif line.manufacturer_type == 'ACCESSORY' %}
						Accessory
					{% else %}
						Other Mfr.
					{% endif %}
				</td>
				<td>
					{% if line.manufacturer_type == 'ILLUMENATE' %}
						{% if line.configured_fixture %}
							<span class="status-configured">Configured</span>
						{% else %}
							<span class="status-pending">Pending</span>
						{% endif %}
					{% elif line.manufacturer_type == 'OTHER' %}
						<span class="status-other">External</span>
					{% else %}
						<span class="status-other">-</span>
					{% endif %}
				</td>
				<td>
					{% if line.spec_document_url %}
						<span class="has-spec">✓ Included</span>
					{% elif line.manufacturer_type == 'ACCESSORY' %}
						<span class="status-other">N/A</span>
					{% else %}
						<span class="no-spec">✗ Missing</span>
					{% endif %}
				</td>
			</tr>
			{% endfor %}
		</tbody>
	</table>

	<div class="footer">
		<p>This document was automatically generated by {{ company_name }} ERP System</p>
		{% if generation_datetime %}
		<p>Generated on {{ generation_datetime }}</p>
		{% endif %}
	</div>
</body>
</html>
